<!DOCTYPE html>
<html lang="en" dir="ltr" id="htmlPage">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Rubyred Transportation - Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800&display=swap" rel="stylesheet">
<link rel="icon" href="pic/logooo.png">
<style>
:root {
    --bg: #0f172a;
    --card-bg: #1e293b;
    --header-bg: #1e293b;
    --text-main: #f1f5f9;
    --text-muted: #94a3b8;
    --border-color: #334155;
    --brand-dark: #ffffff;
    --brand-red: #d80f0f;
    --radius: 20px;
    --shadow: 0 10px 25px -5px rgba(0,0,0,0.3);
}
[data-theme="light"] {
    --bg:#f1f5f9;
    --card-bg:#fff;
    --header-bg:#fff;
    --text-main:#1e293b;
    --text-muted:#64748b;
    --border-color:#e2e8f0;
    --brand-dark:#1e293b;
    --shadow:0 10px 25px -5px rgba(0,0,0,0.05);
}
body { font-family:'Cairo',sans-serif; background:var(--bg); color:var(--text-main); margin:0; padding:10px; transition:0.3s;}
.container { max-width:1200px; margin:0 auto; }
header { background:var(--header-bg); padding:20px; border-radius:var(--radius); margin-bottom:30px; box-shadow:var(--shadow); border:1px solid var(--border-color);}
.header-top { display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; gap:15px; border-bottom:2px solid var(--border-color); padding-bottom:15px; margin-bottom:20px;}
.logo-section { display:flex; align-items:center; gap:12px;}
.logo-section img { max-width:50px; height:auto; }
.logo-section h2 { margin:0; font-size:1.2rem; font-weight:800; color:var(--brand-dark);}
.logo-section h2 span { color:var(--brand-red);}
.controls { display:flex; align-items:center; gap:8px; }
#langSelect,.theme-toggle,.back-btn { padding:8px 12px; border-radius:10px; border:1.5px solid var(--border-color); background:var(--bg); color:var(--text-main); font-family:'Cairo'; font-weight:600; cursor:pointer; outline:none; text-decoration:none; display:flex; align-items:center; font-size:0.85rem; transition:0.2s;}
.back-btn:hover { background:var(--brand-red); color:white; border-color:var(--brand-red);}
.header-main-content { text-align:center;}
.header-main-content h1 { font-size:1.8rem; margin:10px 0;}
.routes-grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(320px,1fr)); gap:20px;}
.card { background:var(--card-bg); border-radius:var(--radius); padding:24px; box-shadow:var(--shadow); border:1px solid var(--border-color); cursor:pointer; transition:0.3s ease; position:relative;}
.card:hover { transform:translateY(-8px); border-color:var(--brand-red); box-shadow:0 20px 25px -5px rgba(216,15,15,0.2);}
.card-header { font-size:1.3rem; font-weight:700; color:var(--brand-red); margin-bottom:15px; border-bottom:2px solid var(--border-color); padding-bottom:8px;}
.stat-row { display:flex; justify-content:space-between; margin-bottom:10px; font-size:0.95rem; border-bottom:1px dashed var(--border-color); padding-bottom:5px;}
.cost-tag { background: rgba(216,15,15,0.1); padding:12px; border-radius:12px; margin-top:15px; display:flex; justify-content:space-between; font-weight:800; color:var(--brand-red);}
.modal { display:none; position:fixed; inset:0; background: rgba(0,0,0,0.8); backdrop-filter:blur(8px); z-index:1000; justify-content:center; align-items:center; padding:20px;}
.modal-content { background:var(--card-bg); width:100%; max-width:1000px; border-radius:24px; max-height:85vh; overflow:hidden; display:flex; flex-direction:column; color:var(--text-main);}
.modal-header { padding:20px 30px; background:var(--brand-red); color:white; display:flex; justify-content:space-between; align-items:center;}
.modal-body { padding:0; overflow-x:auto; overflow-y:auto; min-height:300px;}
table { width:100%; border-collapse:collapse; min-width:600px; text-align:inherit;}
th { background:rgba(0,0,0,0.2); padding:15px 20px; font-weight:700; border-bottom:2px solid var(--border-color); position:sticky; top:0; z-index:5;}
td { padding:15px 20px; border-bottom:1px solid var(--border-color);}
tr:hover { background: rgba(255,255,255,0.05);}
.close-btn { background:none; border:none; color:white; font-size:2.5rem; cursor:pointer; line-height:1;}
@media(max-width:600px){ .header-top{justify-content:center;} .header-main-content h1{font-size:1.4rem;} .routes-grid{grid-template-columns:1fr;} .controls{width:100%; justify-content:center; flex-wrap:wrap;} .back-btn span{display:none;} .back-btn::after{content:'Back';} }
</style>
</head>
<body id="bodyTag">
<div class="container">
<header>
<div class="header-top">
<div class="logo-section">
<img src="pic/logooo.png" alt="RubyRed Logo">
<h2>RUBY<span>RED</span> GARMENT</h2>
</div>
<div class="controls">
<a href="index.html" class="back-btn" id="backLink">
<span id="btnBackText">‚¨Ö Back</span>
</a>
<button class="theme-toggle" onclick="toggleTheme()" id="themeBtn">‚òÄÔ∏è</button>
<select id="langSelect" onchange="setLanguage(this.value)">
<option value="en">English üá∫üá∏</option>
<option value="ar">ÿßŸÑÿπÿ±ÿ®Ÿäÿ© üåç</option>
<option value="tr">T√ºrk√ße üáπüá∑</option>
</select>
</div>
</div>
<div class="header-main-content">
<h1 id="headerTitle">üöç Transport Dashboard</h1>
<p id="headerDesc" style="color:var(--text-muted);">Click any card to view employee details from its sheet</p>
</div>
</header>
<div class="routes-grid" id="routesGrid"></div>
</div>

<div id="dataModal" class="modal">
<div class="modal-content">
<div class="modal-header" id="modalHeader">
<h3 id="modalRouteName" style="margin:0">Employee Details</h3>
<button class="close-btn" onclick="closeModal()">&times;</button>
</div>
<div class="modal-body" id="modalBody">
<table id="dataTable">
<thead id="tableHead"></thead>
<tbody id="tableBody"></tbody>
</table>
</div>
</div>
</div>

<script>
// --- ÿßŸÑÿ™ÿ±ÿ¨ŸÖÿ© ---
const translations={
en:{dir:"ltr",back:"‚¨Ö Back",headerTitle:"üöç Transport Dashboard",headerDesc:"Click any card to view employee details from its sheet",
distance:"üìç Distance:",time:"‚è±Ô∏è Time:",seats:"üí∫ Capacity:",car:"üöê Vehicle:",employees:"üë• Staff:",perEmp:"üíµ Per Staff:",totalCost:"Total Cost:",
currency:"EGP",unitDist:"km",unitTime:"min",unitSeats:"Seats",loading:"Loading Data...",modalTitle:"Route Data",
stations:{"ÿπÿßŸÖÿ±ŸäŸá ŸÖÿÆÿ≤ŸÜ ÿßŸÑÿ≤Ÿäÿ™":"Amriya Oil Storage","ÿπÿßŸÖÿ±ŸäŸá ŸÅŸàŸÇ":"Amriya Up","ÿπÿ®ÿØ ÿßŸÑŸÇÿßÿØÿ± ŸÖÿ®ÿßÿ±ŸÉ":"Abdelkader Mubarak","ÿπÿ®ÿØ ÿßŸÑŸÇÿßÿØÿ± ŸÖÿ≥ÿ™ÿπŸÖÿ±Ÿá":"Abdelkader Colony",
"ÿπÿ®ÿØ ÿßŸÑŸÇÿßÿØÿ± ÿµÿ≠ÿ±ÿßŸàŸä":"Abdelkader Desert","ÿßŸÑŸÜÿßÿµÿ±ŸäŸá":"Nasriya","ÿßŸÑŸÜÿßÿµÿ±ŸäŸá ÿßŸÑŸÇÿØŸäŸÖŸá":"Old Nasriya"}},
ar:{dir:"rtl",back:"ÿ±ÿ¨Ÿàÿπ ‚û°",headerTitle:"üöç ÿ•ÿØÿßÿ±ÿ© ÿÆÿ∑Ÿàÿ∑ ÿßŸÑÿ≥Ÿäÿ±",headerDesc:"ÿßŸÜŸÇÿ± ÿπŸÑŸâ ÿ£Ÿä ŸÉÿßÿ±ÿ™ ŸÑÿπÿ±ÿ∂ ŸÉÿ¥ŸÅ ÿßŸÑŸÖŸàÿ∏ŸÅŸäŸÜ ŸÖŸÜ ÿßŸÑÿ¥Ÿäÿ™ ÿßŸÑŸÖÿÆÿµÿµ ŸÑŸá",
distance:"üìç ÿßŸÑŸÖÿ≥ÿßŸÅÿ©:",time:"‚è±Ô∏è ÿßŸÑŸàŸÇÿ™:",seats:"üí∫ ÿßŸÑÿ≥ÿπÿ©:",car:"üöê ÿßŸÑÿ≥Ÿäÿßÿ±ÿ©:",employees:"üë• ÿπÿØÿØ ÿßŸÑŸÖŸàÿ∏ŸÅŸäŸÜ:",perEmp:"üíµ ÿ™ŸÉŸÑŸÅÿ© ÿßŸÑŸÅÿ±ÿØ:",totalCost:"ÿßŸÑÿ™ŸÉŸÑŸÅÿ© ÿßŸÑŸÉŸÑŸäÿ©:",
currency:"ÿ¨.ŸÖ",unitDist:"ŸÉŸÖ",unitTime:"ÿØ",unitSeats:"ŸÖŸÇÿπÿØ",loading:"ÿ¨ÿßÿ±Ÿä ÿßŸÑÿ™ÿ≠ŸÖŸäŸÑ...",modalTitle:"ÿ®ŸäÿßŸÜÿßÿ™ ÿÆÿ∑",
stations:{"ÿπÿßŸÖÿ±ŸäŸá ŸÖÿÆÿ≤ŸÜ ÿßŸÑÿ≤Ÿäÿ™":"ÿπÿßŸÖÿ±ŸäŸá ŸÖÿÆÿ≤ŸÜ ÿßŸÑÿ≤Ÿäÿ™","ÿπÿßŸÖÿ±ŸäŸá ŸÅŸàŸÇ":"ÿπÿßŸÖÿ±ŸäŸá ŸÅŸàŸÇ","ÿπÿ®ÿØ ÿßŸÑŸÇÿßÿØÿ± ŸÖÿ®ÿßÿ±ŸÉ":"ÿπÿ®ÿØ ÿßŸÑŸÇÿßÿØÿ± ŸÖÿ®ÿßÿ±ŸÉ","ÿπÿ®ÿØ ÿßŸÑŸÇÿßÿØÿ± ŸÖÿ≥ÿ™ÿπŸÖÿ±Ÿá":"ÿπÿ®ÿØ ÿßŸÑŸÇÿßÿØÿ± ŸÖÿ≥ÿ™ÿπŸÖÿ±Ÿá",
"ÿπÿ®ÿØ ÿßŸÑŸÇÿßÿØÿ± ÿµÿ≠ÿ±ÿßŸàŸä":"ÿπÿ®ÿØ ÿßŸÑŸÇÿßÿØÿ± ÿµÿ≠ÿ±ÿßŸàŸä","ÿßŸÑŸÜÿßÿµÿ±ŸäŸá":"ÿßŸÑŸÜÿßÿµÿ±ŸäŸá","ÿßŸÑŸÜÿßÿµÿ±ŸäŸá ÿßŸÑŸÇÿØŸäŸÖŸá":"ÿßŸÑŸÜÿßÿµÿ±ŸäŸá ÿßŸÑŸÇÿØŸäŸÖŸá"}},
tr:{dir:"ltr",back:"‚¨Ö Geri",headerTitle:"üöç G√ºzergah Paneli",headerDesc:"Personel detaylarƒ±nƒ± g√∂rmek i√ßin bir karta tƒ±klayƒ±n",
distance:"üìç Mesafe:",time:"‚è±Ô∏è S√ºre:",seats:"üí∫ Kapasite:",car:"üöê Ara√ß:",employees:"üë• Personel:",perEmp:"üíµ Ki≈üi Ba≈üƒ±:",totalCost:"Toplam Maliyet:",
currency:"EGP",unitDist:"km",unitTime:"dk",unitSeats:"Koltuk",loading:"Y√ºkleniyor...",modalTitle:"G√ºzergah Bilgisi",
stations:{"ÿπÿßŸÖÿ±ŸäŸá ŸÖÿÆÿ≤ŸÜ ÿßŸÑÿ≤Ÿäÿ™":"Amriya Oil Storage","ÿπÿßŸÖÿ±ŸäŸá ŸÅŸàŸÇ":"Amriya Up","ÿπÿ®ÿØ ÿßŸÑŸÇÿßÿØÿ± ŸÖÿ®ÿßÿ±ŸÉ":"Abdelkader Mubarak","ÿπÿ®ÿØ ÿßŸÑŸÇÿßÿØÿ± ŸÖÿ≥ÿ™ÿπŸÖÿ±Ÿá":"Abdelkader Colony",
"ÿπÿ®ÿØ ÿßŸÑŸÇÿßÿØÿ± ÿµÿ≠ÿ±ÿßŸàŸä":"Abdelkader Desert","ÿßŸÑŸÜÿßÿµÿ±ŸäŸá":"Nasriya","ÿßŸÑŸÜÿßÿµÿ±ŸäŸá ÿßŸÑŸÇÿØŸäŸÖŸá":"Old Nasriya"}}
};

let currentLang='en';

// --- ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÉÿ±Ÿàÿ™ ---
const routesData=[
{name:"ÿπÿßŸÖÿ±ŸäŸá ŸÖÿÆÿ≤ŸÜ ÿßŸÑÿ≤Ÿäÿ™",dist:57,time:55,seats:28,cost:16800,perEmp:600,car:"Bus",employees:13},
{name:"ÿπÿßŸÖÿ±ŸäŸá ŸÅŸàŸÇ",dist:37,time:59,seats:28,cost:16380,perEmp:585,car:"Bus",employees:17},
{name:"ÿπÿ®ÿØ ÿßŸÑŸÇÿßÿØÿ± ŸÖÿ®ÿßÿ±ŸÉ",dist:43,time:41,seats:14,cost:14070,perEmp:1005,car:"Hiace",employees:14},
{name:"ÿπÿ®ÿØ ÿßŸÑŸÇÿßÿØÿ± ŸÖÿ≥ÿ™ÿπŸÖÿ±Ÿá",dist:51,time:66,seats:28,cost:21210,perEmp:758,car:"Bus",employees:19},
{name:"ÿπÿ®ÿØ ÿßŸÑŸÇÿßÿØÿ± ÿµÿ≠ÿ±ÿßŸàŸä",dist:43,time:41,seats:14,cost:14070,perEmp:1005,car:"Hiace",employees:14},
{name:"ÿßŸÑŸÜÿßÿµÿ±ŸäŸá",dist:39,time:57,seats:14,cost:15540,perEmp:1110,car:"Hiace",employees:12},
{name:"ÿßŸÑŸÜÿßÿµÿ±ŸäŸá ÿßŸÑŸÇÿØŸäŸÖŸá",dist:38,time:54,seats:14,cost:15540,perEmp:1110,car:"Hiace",employees:13}
];

// --- Theme ---
function toggleTheme(){
const body=document.documentElement;
const btn=document.getElementById('themeBtn');
if(body.getAttribute('data-theme')==='light'){ body.removeAttribute('data-theme'); btn.innerText='‚òÄÔ∏è'; }
else{ body.setAttribute('data-theme','light'); btn.innerText='üåô'; }
}

// --- Render Cards ---
function renderCards(){
const t=translations[currentLang];
const grid=document.getElementById('routesGrid');
grid.innerHTML=routesData.map(r=>`
<div class="card" onclick="openModal('${r.name}')">
<div class="card-header">${t.stations[r.name]}</div>
<div class="stat-row"><span>${t.distance}</span> <strong>${r.dist} ${t.unitDist}</strong></div>
<div class="stat-row"><span>${t.time}</span> <strong>${r.time} ${t.unitTime}</strong></div>
<div class="stat-row"><span>${t.seats}</span> <strong>${r.seats} ${t.unitSeats}</strong></div>
<div class="stat-row"><span>${t.car}</span> <strong>${r.car}</strong></div>
<div class="stat-row"><span>${t.employees}</span> <strong>${r.employees}</strong></div>
<div class="stat-row"><span>${t.perEmp}</span> <strong>${r.perEmp} ${t.currency}</strong></div>
<div class="cost-tag"><span>${t.totalCost}</span><span>${r.cost} ${t.currency}</span></div>
</div>`).join('');
}

// --- Translation ---
function setLanguage(lang){
currentLang=lang;
const t=translations[lang];
document.getElementById('htmlPage').dir=t.dir;
document.getElementById('htmlPage').lang=lang;
document.getElementById('headerTitle').innerText=t.headerTitle;
document.getElementById('headerDesc').innerText=t.headerDesc;
document.getElementById('btnBackText').innerText=t.back;
document.getElementById('modalHeader').style.flexDirection=t.dir==='rtl'?'row-reverse':'row';
renderCards();
}

// --- Modal ---
async function openModal(routeName){
const modal=document.getElementById('dataModal');
const head=document.getElementById('tableHead');
const body=document.getElementById('tableBody');
const t=translations[currentLang];
document.getElementById('modalRouteName').innerText=`${t.modalTitle}: ${t.stations[routeName]}`;
modal.style.display='flex';
document.body.style.overflow='hidden';
head.innerHTML=''; body.innerHTML=`<tr><td colspan="10" style="text-align:center;padding:60px;font-size:1.2rem">${t.loading}</td></tr>`;
try{
const API_URL="https://script.google.com/macros/s/AKfycbw2MeknsfN6Ix2JRkfuYzSX-ec9ZDUtQUZMHj5rZO85PMRLjT3G6UQmJIXlP_niF9LMVA/exec";
const response=await fetch(`${API_URL}?sheet=${encodeURIComponent(routeName)}`);
const data=await response.json();
if(data && data.length>0){
const cols=Object.keys(data[0]);
head.innerHTML=`<tr>${cols.map(c=>`<th>${c}</th>`).join('')}</tr>`;
body.innerHTML=data.map(row=>`<tr>${cols.map(c=>`<td>${row[c]||'-'}</td>`).join('')}</tr>`).join('');
}else{ body.innerHTML=`<tr><td colspan="10" style="text-align:center;padding:60px">No records found in this sheet.</td></tr>`;}
}catch(e){ body.innerHTML=`<tr><td colspan="10" style="color:var(--brand-red);text-align:center;padding:60px">Error connecting to database. Please check your Script URL.</td></tr>`;}
}
function closeModal(){ document.getElementById('dataModal').style.display='none'; document.body.style.overflow='auto'; }
window.onclick=function(e){ if(e.target==document.getElementById('dataModal')) closeModal();}
setLanguage('en');
</script>
</body>
</html>

